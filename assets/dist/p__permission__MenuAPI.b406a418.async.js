(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[25],{"+H1k":function(e,n,t){"use strict";t.r(n);t("IzEo");var a=t("bx4M"),c=(t("T2oS"),t("W9HT")),r=(t("14J3"),t("BMrR")),u=(t("+L6B"),t("2/Rp")),o=(t("y8nQ"),t("Vl3Y")),i=(t("OaEy"),t("2fM7")),d=(t("miYZ"),t("tsqr")),l=t("tJVT"),m=t("q1tI"),s=t.n(m),h=t("Hx5s"),p=t("MuoO"),b=t("4Mzt"),f=(t("Q9mQ"),t("diRs")),k=(t("+BJd"),t("mr32")),g=(t("sRBo"),t("kaz8")),O=t("k1fw"),j=t("0Owb"),E=t("oBTY"),v=(t("Mwp2"),t("VXEj")),I=t("IWSt"),y=t.n(I),C=20,P=250;function _(e){var n=e.permissionTree,t=e.checkedMenu,a=e.checkedAPI,c=e.onMenuChange,r=e.onAPIChange,u=e.disabled,o=void 0!==u&&u,i={};return t.map((function(e){i[e]=!0})),s.a.createElement(v["b"],{bordered:!0,split:!0,className:y.a.menuTree},s.a.createElement(v["b"].Item,null,s.a.createElement("div",{style:{width:"100%",textAlign:"center",display:"grid",gridTemplateColumns:P+"px auto"}},s.a.createElement("div",null,"\u83dc\u5355"),s.a.createElement("div",{style:{borderLeft:"1px solid #eee"}},"API\u6743\u9650"))),n.map((function(n){return s.a.createElement(v["b"].Item,{key:n.path},s.a.createElement(M,Object(j["a"])({disabled:o,checkedAPI:a,checked:t.indexOf(n.path)>-1,menuPath:[],checkedMenu:e.checkedMenu},n,{onAPIChange:function(e){var n=a.filter((function(n){return e.findIndex((function(e){return!e.checked&&e.method==n.method&&e.path==n.path}))<0}));n.push.apply(n,Object(E["a"])(e.filter((function(e){return e.checked})))),r(n)},onMenuChange:function(e){e.map((function(e){i[e.path]=e.checked})),c(Object.keys(i).filter((function(e){return i[e]})).map((function(e){return e})))},depth:0})))})))}function M(e){var n,t=e.depth,a=C*t,c=P-a;return s.a.createElement("div",{className:y.a.menuItem,style:{paddingLeft:C*t+"px"}},s.a.createElement("div",{className:y.a.menuItemContainer,style:{gridTemplateColumns:c+"px auto"}},s.a.createElement("div",null,s.a.createElement(g["a"],{disabled:e.disabled,checked:e.checked,onChange:function(n){if(n.target.checked){e.onMenuChange([].concat(Object(E["a"])(e.menuPath.map((function(e){return{path:e,checked:!0}}))),[{path:e.path,checked:!0}],Object(E["a"])((e.children||[]).map((function(e){return{path:e.path,checked:!0}})))));var t=e.api||[],a=function e(n){var t=[];return n.map((function(n){t.push.apply(t,Object(E["a"])(n.api||[])),n.children&&t.push.apply(t,Object(E["a"])(e(n.children)))})),t};t.push.apply(t,Object(E["a"])(a(e.children||[]))),e.onAPIChange(Object(E["a"])(t.map((function(e){return Object(O["a"])(Object(O["a"])({},e),{},{checked:!0})}))))}else e.onMenuChange([{path:e.path,checked:!1}].concat(Object(E["a"])((e.children||[]).map((function(e){return{path:e.path,checked:!1}})))))}},e.name)),s.a.createElement("div",null,null===(n=e.api)||void 0===n?void 0:n.map((function(n){var t=!1;return e.checkedAPI.map((function(e){e.method===n.method&&e.path===n.path&&(t=!0)})),s.a.createElement("span",{key:n.path+" "+n.method},s.a.createElement(g["a"],{disabled:e.disabled,checked:t,onChange:function(t){e.onAPIChange([Object(O["a"])(Object(O["a"])({},n),{},{checked:t.target.checked})])}},s.a.createElement(f["a"],{title:n.name,content:s.a.createElement("span",null,s.a.createElement(k["a"],{color:"success"},n.method)," ",n.path)},s.a.createElement("span",null,n.name))))})))),s.a.createElement("div",null,(e.children||[]).map((function(n){return s.a.createElement(M,Object(j["a"])({key:n.path,disabled:e.disabled,checkedAPI:e.checkedAPI,onAPIChange:e.onAPIChange,checked:e.checkedMenu.indexOf(n.path)>-1,checkedMenu:e.checkedMenu,onMenuChange:e.onMenuChange,menuPath:[].concat(Object(E["a"])(e.menuPath),[e.path])},n,{depth:t+1}))}))))}var A=_,x=function(e){var n=e.userGroups,t=(e.menu,e.dispatch),p=Object(m["useState"])([]),f=Object(l["a"])(p,2),k=f[0],g=f[1],O=Object(m["useState"])([]),j=Object(l["a"])(O,2),E=j[0],v=j[1],I=Object(m["useState"])("admin"),y=Object(l["a"])(I,2),C=y[0],P=y[1],_=Object(m["useState"])([]),M=Object(l["a"])(_,2),x=M[0],T=M[1],w=Object(m["useState"])(0),S=Object(l["a"])(w,2),G=S[0],B=S[1],J="admin"===C,H=function(e){var n=2;P(e),B(2),Object(b["e"])(e).then((function(e){14e3!==e.code&&(0===e.code?(B(--n),g(e.data||[])):d["b"].error("\u52a0\u8f7d\u83dc\u5355\u6743\u9650\u5931\u8d25:"+e.msg))})),Object(b["d"])(e).then((function(e){0===e.code?(B(--n),v(e.data||[])):d["b"].error("\u52a0\u8f7dAPI\u6743\u9650\u5931\u8d25:"+e.msg)}))};Object(m["useEffect"])((function(){t({type:"userGroup/fetch"}),H("admin"),Object(b["c"])().then((function(e){0===e.code||14e3===e.code?T(e.data):d["b"].error("\u52a0\u8f7d\u6743\u9650\u6811\u5931\u8d25:"+e.msg)}))}),[]);var L=function(){console.log(k,E),d["b"].loading({content:"\u6b63\u5728\u4fdd\u5b58\u83dc\u5355\u6743\u9650",key:"message_save_menu"}),d["b"].loading({content:"\u6b63\u5728\u4fdd\u5b58API\u6743\u9650",key:"message_save_api"}),Object(b["j"])(C,k).then((function(e){0!==e.code&&d["b"].error({content:"\u4fdd\u5b58\u83dc\u5355\u6743\u9650\u5931\u8d25: "+e.msg,key:"message_save_menu",duration:2}),d["b"].success({content:"\u83dc\u5355\u6743\u9650\u4fdd\u5b58\u6210\u529f",key:"message_save_menu",duration:2})})),Object(b["h"])(C,E).then((function(e){0!==e.code&&d["b"].error({content:"\u4fdd\u5b58API\u6743\u9650\u5931\u8d25: "+e.msg,key:"message_save_api",duration:2}),d["b"].success({content:"\u4fdd\u5b58API\u6743\u9650\u6210\u529f",key:"message_save_api",duration:2})}))};return s.a.createElement(h["b"],null,s.a.createElement(a["a"],{style:{minHeight:"600px"}},s.a.createElement(o["a"],null,s.a.createElement(r["a"],null,s.a.createElement(o["a"].Item,{label:"\u7528\u6237\u7ec4"},s.a.createElement(i["a"],{style:{width:"120px"},onSelect:H,value:C},n.map((function(e){return s.a.createElement(i["a"].Option,{value:e.name,key:e.name},e.name)})))),s.a.createElement(u["a"],{style:{marginLeft:"10px"},onClick:L,disabled:J},"\u66f4\u65b0")),s.a.createElement("div",{style:{marginTop:"10px"}},s.a.createElement(c["a"],{spinning:0!==G,tip:"\u52a0\u8f7d\u6743\u9650\u4e2d"},s.a.createElement(A,{disabled:J,onMenuChange:function(e){g(e),console.log(e)},onAPIChange:function(e){v(e),console.log(e)},checkedMenu:k,checkedAPI:E,permissionTree:x}))))))},T=function(e){var n=e.userGroup,t=e.global;return{userGroups:n.userGroups,menu:t.menu}};n["default"]=Object(p["connect"])(T)(x)},IWSt:function(e,n,t){e.exports={menuTree:"menuTree___1raGy",menuItem:"menuItem___11bfG",menuItemContainer:"menuItemContainer___1VvjO"}}}]);